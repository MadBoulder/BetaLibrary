{% extends "templates/templates/es/area-page-layout.html" %}

{% block title %} <title>Boulder en {{ name }} | MadBoulder</title>{% endblock%}
{% block description %} <meta name="description" content="Página sobre boulder en {{ name }} con lista de videos de los bloques, información sobre guías de bloque y previsión del tiempo">{% endblock%}

{% block head %}
<!-- Weather Widget dependencies-->
<script async src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.27.0/moment.min.js"></script>
<script async src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.27.0/locale/ca.min.js"
integrity="sha512-Jj2Leg+TB+LRdCEuGXUD2/sOcZcQqVH1zQ+nk1qGBoojAphBaH90oWeYfiB1xIr3va4AIRnDGQiPopGSv6ATiw=="
crossorigin="anonymous"></script>
<script async src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.27.0/locale/es.min.js"
integrity="sha512-tgY2qswcbQir80Vp67s5ZdbKikl99YmVXp3V/C4Acthk4gI29ONbQ+MR8B5tpESkNoa0N1P7HnSuzC6nOflrwA=="
crossorigin="anonymous"></script>
{% raw %}
<script src="{{url_for('static', filename='js/openWeather.js')}}"></script>

<!-- Table Widget dependencies-->
<link href="https://cdn.datatables.net/v/bs5/dt-1.13.6/datatables.min.css" rel="stylesheet">
<script src="https://cdn.datatables.net/v/bs5/dt-1.13.6/datatables.min.js"></script>
<script defer src="{{url_for('static', filename='js/tabledata-utils.js')}}"></script>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/js/all.min.js" crossorigin="anonymous"></script>
{% endraw %}
<link rel="canonical" href="https://www.madboulder.org/es/{{area_code}}">
<link rel="alternate" hreflang="en" href="https://www.madboulder.org/{{area_code}}">
<link rel="alternate" hreflang="es" href="https://www.madboulder.org/es/{{area_code}}">
{% endblock %} 
{% block zone_name %} {{ name }} Boulder{% endblock %} 

{% block tree %}
	<a href="/bouldering-areas-list" class="zone-header-tree-link">Todas las zonas</a>
	 > 
	<a href="/countries/{{country_code}}" class="zone-header-tree-link">{{ country_name }}</a>
  {% if state_code %}
   > 
  <a href="/states/{{state_code}}" class="zone-header-tree-link">{{ state_name }}</a>
	{% endif %}
{% endblock %} 

{% block stats %}
<h2 style="clear:both;display:block" class="">Estadísticas de {{ name }} Boulder</h2>
<div class="container" style="padding-top: 1rem;">
  <!-- Zone summary -->
  <div id="zone-summary" class="row justify-content-center">
    {% raw %} {% for stat in stats_list %}
    <div class="col-md-2 col-sm-2 stats-col">
      <div class="card mx-sm-1 p-2">
        <div class="card p-2 my-card" style="border-radius: 50%; align-self: baseline;">
          <span class="{{stat['logo']}}" aria-hidden="true"></span>
        </div>
        <div class="text-center mt-2">
          <h5 class="stats-title">{{stat['text']}}</h5>
        </div>
        <div class="text-center mt-1 mb-0">
          <h3 class="stats-content">{{stat['data']}}</h3>
        </div>
      </div>
    </div>
    {% endfor %} {% endraw %}
  </div>
</div>
{% endblock %} 

{% block widget %}
<h2 style="clear:both;display:block" class="">Previsión del Tiempo en {{ name }} Boulder</h2>
<div id="big-weather-widget" class="d-flex justify-content-center align-content-center">
  <input type="hidden" id="lat" name="lat_val" value="{{ lat }}" />
  <input type="hidden" id="lng" name="lng_val" value="{{ lng }}" />
  <!--Weather widget html code-->
  <div class="card mt-3" style="width:80%;">
    <div class="card-header d-flex justify-content-center">
      {{ zone }}
      <!-- This will come from the datafile -->
    </div>
    <div class="row mt-1 mb-1">
      <div class="d-flex col-2 flex-column justify-content-center">
        <img loading="lazy" height="75" class="weather-icon"></img>
        <div class="mx-auto text-capitalize weather-description text-center"></div>
      </div>
      <div class="d-flex col-2 flex-column justify-content-center">
        <div id="current_weather" class="d-flex flex-column justify-content-center" style="margin: 0.75rem;">
          <div class="my-auto d-flex align-items-center">
            <div class="weather-temperature mb-2" style="font-size: large;"></div>
          </div>
          <div class="my-auto">
            <div class="d-flex align-items-center">
              <label style="font-size: small;">Min:&nbsp;</label>
              <div class="weather-min-temperature" style="font-size: small;"></div>
            </div>
            <div class="d-flex align-items-center">
              <label style="font-size: small;">Max:&nbsp;</label>
              <div class="weather-max-temperature" style="font-size: small;"></div>
            </div>
            <div class="d-flex align-items-center">
              <i class="fas fa-wind mr-2">air</i>
              <div class="wind-speed mb-2" style="font-size: small;"></div>
            </div>
          </div>
        </div>
      </div>
      <div class="col-8 d-flex align-content-center flex-wrap">
        <div id="big" class="row weather-forecast" style="margin: inherit;"></div>
      </div>
    </div>
  </div>
</div>

<div id="small-weather-widget" class="container d-flex justify-content-center align-content-center mt-1">
  <!--small weather widget html code-->
  <div class="card mt-1" style="width: 95%;">
    <div class="card-header d-flex justify-content-center" style="font-size: small; padding: 3px;">
      {{ zone }}
      <!-- This will come from the datafile -->
    </div>
    <div class="row">
      <div class="d-flex col-6 flex-column justify-content-center" style="font-size: small;">
        <img loading="lazy" height="60" class="weather-icon"></img>
        <div class="mx-auto weather-description" style="text-transform: capitalize; text-align:center; font-size: small;"></div>
      </div>
      <div class="d-flex col-6 flex-column justify-content-center">
        <div id="current_weather_small" class="d-flex flex-column justify-content-center">
          <div class="my-auto d-flex justify-content-center">
            <div class="weather-temperature mb-2" style="font-size: large;"></div>
          </div>
          <div class="my-auto mx-auto d-flex">
            <div class="col-6 d-flex justify-content-center">
              <label style="font-size: small;">Min:&nbsp;</label>
              <div class="weather-min-temperature" style="font-size: small;"></div>
            </div>
            <div class="col-6 d-flex justify-content-center">
              <label style="font-size: small;">Max:&nbsp;</label>
              <div class="weather-max-temperature" style="font-size: small;"></div>
            </div>
          </div>
          <div class="d-flex justify-content-center">
            <i class="fas fa-wind mr-2">air</i>
            <div class="wind-speed mb-2" style="font-size: small;"></div>
          </div>
        </div>
      </div>
    </div>
    <hr style="margin-top: 0px; margin-bottom: 0px;" />
    <div id="small" class="row d-flex justify-content-center weather-forecast mb-2" style="margin: inherit;">
    </div>
  </div>
</div>

<!-- Ideally, make a python wrapper and pass the values instead of using jQuery? -->
<!-- jQuery, the solution to all your problems -->
{% raw %}
<script>
  $('.weather-temperature').openWeather({
    lat: $('input#lat').val(), // From zone data
    lng: $('input#lng').val(), // From zone data
    iconTarget: '.weather-icon',
    key: 'a7bf54fbd775796a64aad9c5ca7d26ef',
    customIcons: 'images/weather_icons/',
    minTemperatureTarget: '.weather-min-temperature',
    maxTemperatureTarget: '.weather-max-temperature',
    windSpeedTarget: '.wind-speed',
    windSpeedUnit: 'km/h',
    descriptionTarget: '.weather-description',
    forecastTarget: 'weather-forecast',
    lang: '{{ current_lang }}', // from zone data
    query: 'onecall' // to get forecast
  });
</script>
{% endraw %} 
{% endblock %}

{% block topo %}
<div id="main" class="row" style="margin-bottom: 1rem;">
	<div class="col-md-12">
		<div class="tab-content ">
			<div class="row">
				<div class="col-md-6" style="align-self: center; margin-bottom: 1rem;">
					<div id="area-thumbnail" title="Foto de {{ name }} Boulder" style="opacity: 1; filter: saturate(100%);">
						<picture>
							<source media="(min-width: 1200px)" sizes="605px" srcset="{{ playlists["thumbnail"] }}">
							<source media="(min-width: 997px)" sizes="450px" srcset="{{ playlists["thumbnail"] }}">
							<source media="(min-width: 768px)" sizes="330px" srcset="{{ playlists["thumbnail"] }}">
							<img loading="lazy" class="img-fluid d-block" src="{{ playlists["thumbnail"] }}" alt="Foto de {{ name }} Boulder">
						</picture>
					</div>
				</div>
				<div class="col-md-6">
					<div id="general-info" class="overflow-auto d-flex flex-column">
						{% if overview %}
							<div id="features_info" class="position-relative">
								<h2>Escalada en {{ name }}</h2>
								<p style="text-align: justify;">{{ overview }}</p>
							</div>
						{% endif %}
						<div id="general_stats">
							<p style="background: rgba(0,0,0,.075);color: #555555;padding: 5px; margin-bottom: 0;">
								<b>Videos</b> {{ playlists["video_count"] }}
								{% if rock_type %}
									<br>
									<b>Tipo de Roca</b> {{ rock_type }}
								{% endif %}
								{% if alt %}
									<br>
									<b>Altitud</b> {{ alt }}m
								{% endif %}
							</p>
						</div>
					</div>
				</div>
			</div>	
		</div>
	</div>
</div>
{% if guides_list or links_list%}
  <div>
    <h2>Guias de {{ name }} Boulder</h2>
    {% if guides_list %}
      <div class="pl-5 mb-3" style="display: flex; flex-wrap: wrap; justify-content: space-around;">
        {% for guide in guides_list %}
          <div class="mr-2">
            <a id="guide_link" class="text-bold" style="text-decoration: none; color: black;" href="{{ guide["link"] }}" target="_blank">
              <div class="card-body" style="background:none;box-shadow: none;">
                <div class="card-body-image-container">
                  <div class="card-body-image-container-container">
                    <img loading="lazy" class="card-body-image" style="object-fit: contain" src="{{ guide["thumbnail"] }}" alt="{{ guide["name"] }}">
                  </div>
                </div>
                <div class="card-body-title-container">
                  <h6 class="text-bold card-title" style="text-align: center;">{{ guide["name"] }}</h6>
                </div>
              </div>
            </a>
          </div>
        {% endfor %}
      </div>
    {% endif %}
    {% if links_list %}
      <div class="list-group">
        {% for link in links_list %}
          <a id="generic_link" href="{{ link["link"] }}" target="_blank" style="display: flex; align-items: center;" class="list-group-item list-group-item-action list-group-item-light text-bold">
            <i class="fas fa-book" style="margin-right: 0.2rem;"></i>
            {{ link["name"] }}
            {% if link["free"] %}
              <button class="btn-free-madboulder text-bold">
                Gratis
              </button>
            {% endif %}
          </a>
        {% endfor %}
      </div>
    {% endif %}
  </div>
{% endif %}
{% endblock %} 

{% block map %}
<!-- Zone Map -->
<h2 style="clear:both;display:block" class="">Mapa de {{ name }} Boulder</h2>
<div class="container">
	<div style="position: relative; padding-top: 56%;">
		<iframe
			src="{{ map_url }}"
			frameborder="0"
		  loading="lazy"
			allowfullscreen
			style="position: absolute; top: 0; left: 0; width: 100%; height: 100%;">
		</iframe>
	</div>
</div>
{% endblock %}

{% block problems %}
<!--Problem List-->
<h2 style="clear:both;display:block" class="">Lista de {{ problems|length }} Bloques en Video de {{ name }} Boulder</h2>
<div class="container">
	<input id="search-problem" class="form-control  mb-2" type="text" placeholder="Search" aria-label="Search" style="display: grid; align-self: center; border-color: black;">
	<table id="problems-table" class="table table-hover">
		<thead>
			<tr>
				{% raw %}
				<th scope="col" class="sorting">Nombre</th>
				<th scope="col" class="sorting">Grado</th>
				<th scope="col" class="sorting">Sector</th>
				{% endraw %}
			</tr>
		</thead>
		<tbody style="vertical-align: middle;">
			{% for problem in problems %}
				<tr class="problem-row">
					<td>
            <div class="problem-thumbnail-cell">
              <a aria-hidden="false" aria-label="{{ problem["title"] }}" href="/problems/{{area_code}}/{{problem['secure']}}" tabindex="0" target="">
                <div class="video-thumbnail-container">
                  <img class="video-thumbnail-img" loading="lazy" alt="Video thumbnail de {{ problem["title"] }}" src="https://img.youtube.com/vi/{{ problem["id"] }}/mqdefault.jpg">
                </div>
              </a>
              <a href="/problems/{{area_code}}/{{problem['secure']}}" class="table-row-name text-bold">{{ problem["name"] }}</a>
            </div>
					</td>
					<td>{{ problem["grade_with_info"] }}</td>
					<td>{{ problem["sector"] }}</td>
				</tr>
			{% endfor %}
		</tbody>
	</table>
	<script>
		$(document).ready(function () {
			$('#problems-table').DataTable({
				paging: false,
				dom: 'tr',
				columnDefs: [
					{
						targets: [1],
						type: 'custom-grade',
					},
				]
			});
			
			$("#search-problem").trigger("keyup");
				
			$("#search-problem").keyup(function() {
				var search_query = $.trim($(this).val());
				var items = $(".problem-row");
				filter_items_by_query(search_query, items)
			});
		});
	</script>
</div>
{% endblock %}

{% block sectors %}
<!--Sector List-->
<h2 style="clear:both;display:block" class="">Lista de {{ sectors|length }} Sectores de {{ name }} Boulder</h2>
<div class="container">
	<input id="search-sector" class="form-control  mb-2" type="text" placeholder="Search" aria-label="Search" style="display: grid; align-self: center; border-color: black;">
	<table id="sectors-table" class="table table-hover">
		<thead>
			<tr>
				{% raw %}
				<th scope="col" class="sorting">Nombre</th>
				<th scope="col" class="sorting">Bloques</th>
				{% endraw %}
			</tr>
		</thead>
		<tbody>
			{% for sector in sectors %}
				<tr class="sector-row">
					<td>
						<a href="/sectors/{{area_code}}/{{sector[1]}}" class="table-row-name text-bold">{{ sector[0] }}</a>
					</td>
					<td class="text-center">{{ sector[2] }}</td>
				</tr>
			{% endfor %}
		</tbody>
	</table>
	<script>
		$(document).ready(function () {
			$('#sectors-table').DataTable({
				paging: false,
				dom: 'tr'
			});
			$("#search-sector").trigger("keyup");
				
			$("#search-sector").keyup(function() {
				var search_query = $.trim($(this).val());
				var items = $(".sector-row");
				filter_items_by_query(search_query, items)
			});
		});
	</script>
</div>
{% endblock %}

{% block playlists %}
<!--Playlists-->
<h2 style="clear:both;display:block" class="">{{ playlists|length }} Listas de Reproducción de {{ name }} Boulder</h2>
<div class="container">
  <div class="row">
    <div class="col-sm-3 col-md-3"></div>
    <div class="col-sm-6 col-md-6">
      <p class="text-center">
        {% raw %}
        <b>Completa</b>
        {% endraw %}
      </p>
      <div style="position: relative; padding-top: 56.25%;">
        <iframe
          src="https://www.youtube.com/embed/?listType=playlist&list={{ playlists['id'] }}"
          frameborder="0"
          loading="lazy"
          allowfullscreen
          style="
            position: absolute;
            top: 0;
            left: 0%;
            width: 100%;
            height: 100%;
          "
        >
        </iframe>
      </div>
    </div>
    <div class="col-sm-3 col-md-3"></div>
  </div>
  {% for sector in playlists['sectors'] %}
  <br />
  <div class="row">
    <div class="col-sm-3 col-md-3"></div>
    <div class="col-sm-6 col-md-6">
      <p class="text-center">
        <b>{{ sector['name'] }}</b>
      </p>
      <div style="position: relative; padding-top: 56.25%;">
        <iframe
          src="https://www.youtube.com/embed/?listType=playlist&list={{ sector['id'] }}"
          frameborder="0"
          loading="lazy"
          allowfullscreen
          style="
            position: absolute;
            top: 0;
            left: 0%;
            width: 100%;
            height: 100%;
          "
        >
        </iframe>
      </div>
    </div>
    <div class="col-sm-3 col-md-3"></div>
  </div>
  {% endfor %}
{% endblock %}
